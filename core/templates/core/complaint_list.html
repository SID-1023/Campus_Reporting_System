{% extends "core/base.html" %}

{% block title %}All Complaints — Campus Reporting{% endblock %}

{% block page_title %}All Complaints{% endblock %}

{% block content %}
<div class="container-fluid p-0">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>All Complaints</h2>
        <a href="{% url 'report_complaint' %}" class="btn btn-primary" style="background:linear-gradient(90deg,#5ee7df,#7b61ff); border:none;">➕ Submit New</a>
    </div>

    <!-- Search and Filters -->
    <form method="get" class="d-flex gap-2 flex-wrap mb-3">
        <input type="text" name="q" value="{{ q }}" placeholder="Search title, description, location" class="form-control" style="max-width:250px;">
        <select name="category" class="form-select" style="max-width:180px;">
            <option value="">All Categories</option>
            {% for val,label in category_choices %}
                <option value="{{ val }}" {% if selected_category == val %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <select name="status" class="form-select" style="max-width:150px;">
            <option value="">All Status</option>
            {% for val,label in status_choices %}
                <option value="{{ val }}" {% if selected_status == val %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary" style="background:linear-gradient(90deg,#5ee7df,#7b61ff); border:none;">Filter</button>
        <a href="{% url 'complaint_list' %}" class="btn btn-outline-secondary">Reset</a>
    </form>

    <!-- Complaints Grid -->
    <div class="row g-3">
        {% if complaints %}
            {% for complaint in complaints %}
                <div class="col-md-6">
                    <div class="p-3 mb-3" style="border-radius:18px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.14); backdrop-filter: blur(12px) saturate(140%);">
                        <a href="#" style="font-size:1.25rem; font-weight:800; color:#0b4cff;">{{ complaint.title }}</a>
                        <p class="mt-2 mb-1"><strong>Category:</strong> {{ complaint.category }} | <strong>Location:</strong> {{ complaint.location }}</p>
                        {% if complaint.image %}
                            <img src="{{ complaint.image.url }}" class="img-fluid rounded mb-2">
                        {% endif %}
                        <small class="text-muted">{{ complaint.created_at|date:"M d, Y — h:i A" }}</small>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-info">No complaints found.</div>
        {% endif %}
    </div>

</div>
{% endblock %}
